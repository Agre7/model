!function(a,b){"object"==typeof exports?module.exports=b():"function"==typeof define&&define.amd?define([],b):a.Model=b()}(this,function(){function a(){function a(a,b){"string"==typeof a?e(a,b):d(a)}function d(a){Object.keys(a).forEach(function(b){e(b,a[b])})}function e(a,b){o[a]=b,n[a]&&n[a].forEach(function(a){a()})}function f(a){return o[a]}function g(){var a=[];return function d(e,g,i){e instanceof Array||(e=[e]);var k=b(function(){var a=e.map(f);c(a)&&h(g,i,a,e)});return k(),e.forEach(function(b){j(b,k),a.push({property:b,fn:k})}),{when:d,callbacks:a}}}function h(a,b,c){a.apply(b,c)}function i(a){a.callbacks.forEach(function(a){k(a.property,a.fn)})}function j(a,b){n[a]||(n[a]=[]),n[a].push(b)}function k(a,b){n[a]=n[a].filter(function(a){return a!==b})}function l(){}var m={set:a,get:f,when:function(a,b,c){return g()(a,b,c)},cancel:i,detectFlowGraph:l},n={},o={};return m}function b(a){var b=!1;return function(){b||(b=!0,setTimeout(function(){b=!1,a()},0))}}function c(a){return!a.some(function(a){return"undefined"==typeof a||null===a})}return a});